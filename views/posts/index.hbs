<h1>Timeline</h1>
<a class="new-post-link" href="/posts/new">New post</a>
<ul class="posts" >
 {{#each posts}}
<div class="card">
  <div class="post-user">
   <li><small style= "font-size:0.7em">{{this.user.email}}</small></li>
  </div>
   <div class="post-date" style = "position:sticky; left:100%;";>
    <li><small style= "font-size:0.7em">{{this.time}}</small></li>
  </div>
  <div class="post-message">
  <li>{{this.message}}</li>
  </div>
  <form action='/posts/{{this.id}}?_method=DELETE' method='POST'>
  <div class="btn-text-right">
  <button class="btn"><i class="fa fa-trash"></i></button>
  </div>
</form>
{{!-- <button id="#likes-count-" class="btn"><i class="fa fa-thumbs-up"></i></button> --}}
<button onclick="actOnPost(event);"
  data-post-id="{{ this.id }}">Like</button>
  <span id="likes-count-{{ this.id }}">{{ this.likes_count }}</span>
</div>
  
  {{/each}}
</ul>



<form action='/sessions?_method=DELETE' method='POST'>
  <button type="submit" value="Log Out">Log out</button>
</form>

<script>
  var updatePostStats = {
    Like: function (postId) {
      document.querySelector('#likes-count-' + postId).textContent++;
    },
    Unlike: function(postId) {
      document.querySelector('#likes-count-' + postId).textContent--;
    }
  };
  var toggleButtonText = {
    Like: function(button) {
      button.textContent = "Unlike";
    },
    Unlike: function(button) {
      button.textContent = "Like";
    }
  };
  var actOnPost = function (event) {
    var postId = event.target.dataset.postId;
    var action = event.target.textContent.trim();
    toggleButtonText[action](event.target);
    updatePostStats[action](postId);
    axios.post('/posts/' + postId + '?_method=UPDATE');
  };
  </script>
